{
    "displayName": "qwen3_4b_ent",
    "recipeConfig": {
      "type": "train",
      "datasetId": 0,
      "trainingConfig": {
        "data": {
          "train": {
            "datasets": [
              {
                "datasetName": "multilingual_thinking",
                "datasetPath": "string",
                "subset": "string",
                "split": "train",
                "datasetKwargs": {
                  "additionalProp1": {}
                },
                "seed": 42,
                "trustRemoteCode": false
              }
            ],
            "collatorName": "text_completions_only_with_padding",
            "collatorKwargs": {
              "responseTemplate": "<|im_start|>assistant",
              "instructionTemplate": "<|im_start|>system"
            },
            "targetCol": "messages",
            "seed": 42,
            "useTorchdata": true
          }
        },
        "model": {
          "modelName": "Qwen/Qwen3-4B",
          "tokenizerName": "string",
          "tokenizerPadToken": "string",
          "tokenizerKwargs": {
            "additionalProp1": {}
          },
          "modelMaxLength": 16000,
          "loadPretrainedWeights": true,
          "trustRemoteCode": true,
          "torchDtypeStr": "auto",
          "compile": false,
          "chatTemplate": "string",
          "attnImplementation": "flash_attention_2",
          "deviceMap": "auto"
        },
        "training": {
          "trainerType": "trl_sft",
          "enableGradientCheckpointing": true,
          "gradientCheckpointingKwargs": {
            "use_reentrant": false
          },
          "outputDir": "output/qwen3_4b.fft",
          "perDeviceTrainBatchSize": 1,
          "perDeviceEvalBatchSize": 2,
          "gradientAccumulationSteps": 16,
          "numTrainEpochs": 3,
          "saveEpoch": true,
          "saveSteps": 0,
          "saveFinalModel": true,
          "seed": 42,
          "dataSeed": 42,
          "useDeterministic": false,
          "fullDeterminism": false,
          "runName": "qwen3_4b_ent",
          "logLevel": "info",
          "depLogLevel": "warning",
          "logExamples": false,
          "enableWandb": true,
          "enableMlflow": true,
          "loggingStrategy": "steps",
          "loggingSteps": 2,
          "loggingFirstStep": false,
          "evalStrategy": "steps",
          "evalSteps": 20,
          "learningRate": 5e-05,
          "lrSchedulerType": "cosine",
          "lrSchedulerKwargs": {
            "additionalProp1": {}
          },
          "warmupRatio": 0,
          "warmupSteps": 0,
          "optimizer": "adamw_torch_fused",
          "weightDecay": 0,
          "includePerformanceMetrics": true,
          "logModelSummary": false,
          "dataloaderNumWorkers": "auto",
          "dataloaderPrefetchFactor": 32,
          "ddpFindUnusedParameters": true,
          "maxGradNorm": null,
          "emptyDeviceCacheSteps": 50,
          "trainerKwargs": {
            "additionalProp1": {}
          }
      }
        }
    }
}
